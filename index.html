<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>114å¹´åœ‹è»å¹´çµ‚è€ƒçè‡ªå‹•è©¦ç®—</title>
    <style>
        :root { --primary: #2c3e50; --secondary: #27ae60; --accent: #e74c3c; }
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background-color: #f0f2f5; margin: 0; padding: 20px; display: flex; justify-content: center; }
        .container { background: white; width: 100%; max-width: 500px; padding: 25px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: var(--primary); border-bottom: 2px solid #eee; padding-bottom: 15px; }
        .card { background: #f8f9fa; border: 1px solid #e9ecef; padding: 15px; border-radius: 12px; margin-bottom: 20px; }
        .card-title { font-weight: bold; color: #1a5fb4; margin-bottom: 10px; display: block; border-left: 4px solid #1a5fb4; padding-left: 10px; }
        label { display: block; font-size: 14px; margin: 10px 0 5px; color: #555; }
        select { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #ccc; font-size: 16px; background: white; margin-bottom: 10px; }
        .checkbox-group { display: flex; align-items: center; gap: 8px; margin: 10px 0; font-size: 15px; }
        button { width: 100%; padding: 15px; background: var(--secondary); color: white; border: none; border-radius: 10px; font-size: 18px; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 10px; }
        button:hover { background: #219150; }
        #result { margin-top: 25px; padding: 20px; border-radius: 12px; background: #e8f5e9; display: none; border: 1px solid #c8e6c9; }
        .res-line { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 16px; }
        .total-line { border-top: 1px solid #ccc; padding-top: 10px; margin-top: 10px; font-weight: bold; color: var(--accent); font-size: 20px; }
    </small>
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ–ï¸ 114å¹´è–ªè³‡è©¦ç®—ç³»çµ±</h2>

    <div class="card">
        <span class="card-title">1. å¹´çµ‚çé‡‘ (12æœˆéšç´š)</span>
        <label>éšç´š</label>
        <select id="r1" onchange="updateLevels('l1', this.value)"></select>
        <label>ä¿¸ç´š</label>
        <select id="l1"></select>
        <div class="checkbox-group">
            <input type="checkbox" id="b1" checked> <label for="b1">æ”¯é ˜é ˜å°è·å‹™åŠ çµ¦</label>
        </div>
    </div>

    <div class="card">
        <span class="card-title">2. è€ƒç¸¾çé‡‘ (ç”Ÿæ•ˆéšç´š)</span>
        <label>éšç´š</label>
        <select id="r2" onchange="updateLevels('l2', this.value)"></select>
        <label>ä¿¸ç´š</label>
        <select id="l2"></select>
        <div class="checkbox-group">
            <input type="checkbox" id="b2" checked> <label for="b2">æ”¯é ˜é ˜å°è·å‹™åŠ çµ¦</label>
        </div>
        <label>è€ƒç¸¾ç­‰ç¬¬</label>
        <select id="eval">
            <option value="1">ç”²ç­‰ (1.0å€‹æœˆ)</option>
            <option value="0.5">ä¹™ä¸Š (0.5å€‹æœˆ)</option>
        </select>
    </div>

    <button onclick="doCalculate()">ç«‹å³è¨ˆç®—ç¸½é‡‘é¡</button>

    <div id="result">
        <div class="res-line"><span>å¹´çµ‚çé‡‘ï¼š</span><span id="res_y"></span></div>
        <div class="res-line"><span>è€ƒç¸¾çé‡‘ï¼š</span><span id="res_e"></span></div>
        <div class="total-line"><span>é è¨ˆæ’¥ä»˜ç¸½è¨ˆï¼š</span><span id="res_t"></span></div>
        <p style="font-size:12px; color:#666; margin-top:10px;">*æ•¸æ“šæºè‡ª 114 å¹´èª¿æ•´å¾Œè–ªè³‡è¡¨ï¼Œå¯¦éš›å…¥å¸³éœ€æ‰£é™¤å¥ä¿èˆ‡é€€æ’«åŸºé‡‘ã€‚</p>
    </div>
</div>

<script>
// ç›´æ¥å°‡ XLSX æ•¸æ“šé›†æˆè‡³æ­¤ (ç°¡åŒ–ç¤ºæ„ï¼ŒåŒ…å«ä¸»è¦éšç´šæ•¸æ“š)
// æ•¸æ“šçµæ§‹: [éé ˜å°å¹´çµ‚, éé ˜å°è€ƒç, é ˜å°å¹´çµ‚, é ˜å°è€ƒç] (æ¯ç´šå¢åŠ é¡)
const db = {
    "ä¸Šæ ¡": { start: [114450, 76300, 134715, 89810], diff: [2310, 1540], max: 12 },
    "ä¸­æ ¡": { start: [93135, 62090, 107415, 71610], diff: [1785, 1190], max: 12 },
    "å°‘æ ¡": { start: [79785, 53190, 92250, 61500], diff: [1575, 1050], max: 12 },
    "ä¸Šå°‰": { start: [68130, 45420, 76860, 51240], diff: [1245, 830], max: 12 },
    "ä¸­å°‰": { start: [58680, 39120, 65955, 43970], diff: [1155, 770], max: 12 },
    "å°‘å°‰": { start: [53430, 35620, 59685, 39790], diff: [1155, 770], max: 10 },
    "ä¸€ç­‰å£«å®˜é•·": { start: [67185, 44790, 75525, 50350], diff: [1020, 680], max: 12 },
    "äºŒç­‰å£«å®˜é•·": { start: [57975, 38650, 65535, 43690], diff: [930, 620], max: 12 },
    "ä¸‰ç­‰å£«å®˜é•·": { start: [52545, 35030, 59370, 39580], diff: [855, 570], max: 12 },
    "ä¸Šå£«": { start: [46290, 30860, 50985, 33990], diff: [945, 630], max: 12 },
    "ä¸­å£«": { start: [41430, 27620, 45540, 30360], diff: [810, 540], max: 12 },
    "ä¸‹å£«": [18510+20340, 18510, 22440, 540], // é€™è£¡ä¿®æ­£ä¸­å£«èˆ‡ä¸‹å£«é‚è¼¯
    "ä¸Šå…µ": { start: [57240, 38160, 57240, 38160], diff: [0, 0], max: 1 },
    "ä¸€å…µ": { start: [55170, 36780, 55170, 36780], diff: [0, 0], max: 1 },
    "äºŒå…µ": { start: [53130, 35420, 53130, 35420], diff: [0, 0], max: 1 }
};

// ä¿®æ­£ä¸­å£«æ•¸æ“šè£œå…¨ (ç›´æ¥æŠ“å–æ‚¨æä¾›çš„ XLSX æ•¸æ“šè¦å¾‹)
db["ä¸­å£«"] = { start: [61425, 40950, 65535, 43690], diff: [810, 540], max: 12 };
db["ä¸‹å£«"] = { start: [50580, 33720, 54315, 36210], diff: [810, 540], max: 12 };

const ranks = Object.keys(db);

function init() {
    const sel1 = document.getElementById('r1');
    const sel2 = document.getElementById('r2');
    ranks.forEach(r => {
        sel1.add(new Option(r, r));
        sel2.add(new Option(r, r));
    });
    sel1.value = "ä¸­å£«";
    sel2.value = "ä¸Šå£«";
    updateLevels('l1', "ä¸­å£«");
    updateLevels('l2', "ä¸Šå£«");
}

function updateLevels(id, rank) {
    const lSel = document.getElementById(id);
    lSel.innerHTML = "";
    for(let i=1; i<=db[rank].max; i++) {
        lSel.add(new Option(i + "ç´š", i-1));
    }
}

function doCalculate() {
    // å¹´çµ‚ (ä¸­å£«)
    const rank1 = document.getElementById('r1').value;
    const lv1 = parseInt(document.getElementById('l1').value);
    const boss1 = document.getElementById('b1').checked;
    const d1 = db[rank1];
    const yearEnd = (boss1 ? d1.start[2] : d1.start[0]) + (lv1 * d1.diff[0]);

    // è€ƒç (ä¸Šå£«)
    const rank2 = document.getElementById('r2').value;
    const lv2 = parseInt(document.getElementById('l2').value);
    const boss2 = document.getElementById('b2').checked;
    const rate = parseFloat(document.getElementById('eval').value);
    const d2 = db[rank2];
    const evalFull = (boss2 ? d2.start[3] : d2.start[1]) + (lv2 * d2.diff[1]);
    const evalFinal = evalFull * rate;

    // é¡¯ç¤º
    document.getElementById('res_y').innerText = "$" + Math.round(yearEnd).toLocaleString();
    document.getElementById('res_e').innerText = "$" + Math.round(evalFinal).toLocaleString();
    document.getElementById('res_t').innerText = "$" + Math.round(yearEnd + evalFinal).toLocaleString();
    document.getElementById('result').style.display = 'block';
}

init();
</script>

</body>
</html>