<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>114å¹´åœ‹è»è–ªè³‡è©¦ç®—-æœ€çµ‚æ­£ç¢ºç‰ˆ</title>
    <style>
        :root { --p: #2c3e50; --s: #27ae60; --d: #e74c3c; }
        body { font-family: sans-serif; background: #f0f2f5; padding: 15px; display: flex; justify-content: center; }
        .box { background: white; width: 100%; max-width: 480px; padding: 25px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: var(--p); margin-bottom: 20px; }
        .card { background: #f8f9fa; border: 1px solid #dee2e6; padding: 15px; border-radius: 12px; margin-bottom: 15px; }
        .title { font-weight: bold; color: #1a5fb4; display: block; margin-bottom: 10px; }
        select { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #ccc; font-size: 16px; margin-top: 5px; }
        .check { display: flex; align-items: center; gap: 8px; margin: 15px 0; font-weight: bold; }
        button { width: 100%; padding: 15px; background: var(--s); color: white; border: none; border-radius: 10px; font-size: 18px; font-weight: bold; cursor: pointer; }
        #res { margin-top: 20px; padding: 20px; border-radius: 12px; background: #fffde7; display: none; border: 1px solid #ffe082; }
        .line { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 17px; }
        .total { border-top: 2px solid #ffca28; padding-top: 10px; font-weight: bold; color: var(--d); font-size: 22px; }
    </style>
</head>
<body>

<div class="box">
    <h2>ğŸ–ï¸ 114å¹´è–ªè³‡è©¦ç®—ç³»çµ±</h2>

    <div class="card">
        <span class="title">1. å¹´çµ‚çé‡‘ (12æœˆéšç´š)</span>
        <select id="r1" onchange="update('l1', this.value)"></select>
        <select id="l1" style="margin-top:10px;"></select>
        <div class="check">
            <input type="checkbox" id="b1" checked> <label for="b1">å…·å‚™é ˜å°è·åŠ çµ¦</label>
        </div>
    </div>

    <div class="card">
        <span class="title">2. è€ƒç¸¾çé‡‘ (ç”Ÿæ•ˆéšç´š)</span>
        <select id="r2" onchange="update('l2', this.value)"></select>
        <select id="l2" style="margin-top:10px;"></select>
        <div class="check">
            <input type="checkbox" id="b2" checked> <label for="b2">å…·å‚™é ˜å°è·åŠ çµ¦</label>
        </div>
        <select id="ev" style="margin-top:10px;">
            <option value="1">ç”²ç­‰ (1.0å€‹æœˆ)</option>
            <option value="0.5">ä¹™ä¸Š (0.5å€‹æœˆ)</option>
        </select>
    </div>

    <button onclick="calc()">ç«‹å³è¨ˆç®—ç¸½çé‡‘</button>

    <div id="res">
        <div class="line"><span>å¹´çµ‚çé‡‘ï¼š</span><span id="ry"></span></div>
        <div class="line"><span>è€ƒç¸¾çé‡‘ï¼š</span><span id="re"></span></div>
        <div class="line total"><span>ç¸½é¡é ä¼°ï¼š</span><span id="rt"></span></div>
    </div>
</div>

<script>
// ä¾æ“šæ‚¨ Excel å…§æ•¸æ“šç²¾ç¢ºå¡«å¯« (ä¸å†ä½¿ç”¨è¨ˆç®—å…¬å¼ï¼Œé¿å…èª¤å·®)
const data = {
    "ä¸Šæ ¡": { y1:[134715,137025,139320], e1:[89810,91350,92880] },
    "ä¸­æ ¡": { y1:[107415,109200,110985], e1:[71610,72800,73990] },
    "å°‘æ ¡": { y1:[92250,93825,95400], e1:[61500,62550,63600] },
    "ä¸Šå°‰": { y1:[76860,78105,79350], e1:[51240,52070,52900] },
    "ä¸­å°‰": { y1:[65955,67110,68265], e1:[43970,44740,45510] },
    "ä¸Šå£«": { y1:[67695,68640,69585], e1:[45130,45760,46390] }, // ä¸€ç´šè€ƒç 45130
    "ä¸­å£«": { y1:[61425,62235,63045,63855], e1:[40950,41490,42030,42570] }, // äºŒç´šå¹´çµ‚ 62235
    "ä¸‹å£«": { y1:[54315,55125,55935], e1:[36210,36750,37290] }
};

function init() {
    const s1 = document.getElementById('r1');
    const s2 = document.getElementById('r2');
    Object.keys(data).forEach(r => {
        s1.add(new Option(r, r)); s2.add(new Option(r, r));
    });
    s1.value = "ä¸­å£«"; s2.value = "ä¸Šå£«";
    update('l1', "ä¸­å£«"); update('l2', "ä¸Šå£«");
    document.getElementById('l1').value = 1; // é è¨­äºŒç´š
}

function update(id, r) {
    const s = document.getElementById(id);
    s.innerHTML = "";
    data[r].y1.forEach((val, i) => s.add(new Option((i+1)+"ç´š", i)));
}

function calc() {
    const r1 = document.getElementById('r1').value;
    const l1 = document.getElementById('l1').value;
    const r2 = document.getElementById('r2').value;
    const l2 = document.getElementById('l2').value;
    const rate = document.getElementById('ev').value;

    // ç›´æ¥å–å€¼
    const y = data[r1].y1[l1];
    const e = data[r2].e1[l2] * rate;

    document.getElementById('ry').innerText = "$" + y.toLocaleString();
    document.getElementById('re').innerText = "$" + Math.round(e).toLocaleString();
    document.getElementById('rt').innerText = "$" + Math.round(y + e).toLocaleString();
    document.getElementById('res').style.display = 'block';
}
init();
</script>
</body>
</html>
