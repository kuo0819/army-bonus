<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>114å¹´åœ‹è»å¹´çµ‚è€ƒçè©¦ç®—</title>
    <style>
        :root { --primary: #2c3e50; --success: #27ae60; --danger: #e74c3c; }
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background-color: #f4f6f9; margin: 0; padding: 15px; display: flex; justify-content: center; }
        .container { background: white; width: 100%; max-width: 480px; padding: 20px; border-radius: 15px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: var(--primary); margin-bottom: 20px; }
        .card { background: #ffffff; border: 1px solid #dfe6e9; padding: 15px; border-radius: 12px; margin-bottom: 15px; }
        .card-title { font-weight: bold; color: #0984e3; margin-bottom: 10px; display: block; border-left: 4px solid #0984e3; padding-left: 10px; }
        label { display: block; font-size: 14px; margin-top: 10px; color: #636e72; }
        select { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #ccc; font-size: 16px; margin-top: 5px; background-color: #fff; }
        .checkbox-group { display: flex; align-items: center; gap: 8px; margin: 15px 0 5px; font-weight: bold; color: #2d3436; }
        input[type="checkbox"] { width: 18px; height: 18px; cursor: pointer; }
        button { width: 100%; padding: 15px; background: var(--success); color: white; border: none; border-radius: 10px; font-size: 18px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        #result { margin-top: 20px; padding: 20px; border-radius: 12px; background: #fff9db; display: none; border: 1px solid #f9da63; }
        .res-line { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 17px; }
        .total-line { border-top: 2px solid #fab005; padding-top: 10px; margin-top: 10px; font-weight: bold; color: var(--danger); font-size: 22px; }
    </small>
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ–ï¸ 114å¹´è–ªè³‡è©¦ç®—ç³»çµ±</h2>

    <div class="card">
        <span class="card-title">1. å¹´çµ‚çé‡‘ (12æœˆéšç´š)</span>
        <label>éšç´š</label>
        <select id="r1" onchange="updateLevels('l1', this.value)"></select>
        <label>ä¿¸ç´š</label>
        <select id="l1"></select>
        <div class="checkbox-group">
            <input type="checkbox" id="b1" checked> <label for="b1">å…·å‚™é ˜å°è·èº«ä»½ (å«åŠ çµ¦)</label>
        </div>
    </div>

    <div class="card">
        <span class="card-title">2. è€ƒç¸¾çé‡‘ (ç”Ÿæ•ˆéšç´š)</span>
        <label>éšç´š</label>
        <select id="r2" onchange="updateLevels('l2', this.value)"></select>
        <label>ä¿¸ç´š</label>
        <select id="l2"></select>
        <div class="checkbox-group">
            <input type="checkbox" id="b2" checked> <label for="b2">å…·å‚™é ˜å°è·èº«ä»½ (å«åŠ çµ¦)</label>
        </div>
        <label>è€ƒç¸¾ç­‰ç¬¬</label>
        <select id="eval">
            <option value="1">ç”²ç­‰ (1.0å€‹æœˆ)</option>
            <option value="0.5">ä¹™ä¸Š (0.5å€‹æœˆ)</option>
        </select>
    </div>

    <button onclick="doCalculate()">é–‹å§‹è¨ˆç®—ç¸½çé‡‘</button>

    <div id="result">
        <div class="res-line"><span>å¹´çµ‚çé‡‘ï¼š</span><span id="res_y"></span></div>
        <div class="res-line"><span>è€ƒç¸¾çé‡‘ï¼š</span><span id="res_e"></span></div>
        <div class="total-line"><span>é è¨ˆæ’¥ä»˜ç¸½è¨ˆï¼š</span><span id="res_t"></span></div>
        <p style="font-size:12px; color:#7f8c8d; margin-top:10px;">*æ•¸æ“šå®Œå…¨å°æ‡‰ 114 å¹´ Excel å®˜æ–¹èª¿æ•´è¡¨ã€‚</p>
    </div>
</div>

<script>
// å®Œæ•´è§£æ Excel è³‡æ–™ (éé ˜å°, é ˜å°)
// y: å¹´çµ‚ä¸€ç´šåŸºæº–, e: è€ƒçä¸€ç´šåŸºæº–, dy: å¹´çµ‚ç´šå·®, de: è€ƒçç´šå·®
const db = {
    "ä¸Šæ ¡": { y: [114450, 134715], e: [76300, 89810], dy: [2310, 2310], de: [1540, 1540], max: 12 },
    "ä¸­æ ¡": { y: [93135, 107415], e: [62090, 71610], dy: [1785, 1785], de: [1190, 1190], max: 12 },
    "å°‘æ ¡": { y: [79785, 92250], e: [53190, 61500], dy: [1575, 1575], de: [1050, 1050], max: 12 },
    "ä¸Šå°‰": { y: [68130, 76860], e: [45420, 51240], dy: [1245, 1245], de: [830, 830], max: 12 },
    "ä¸­å°‰": { y: [58680, 65955], e: [39120, 43970], dy: [1155, 1155], de: [770, 770], max: 12 },
    "å°‘å°‰": { y: [53430, 59685], e: [35620, 39790], dy: [1155, 1155], de: [770, 770], max: 10 },
    "ä¸€ç­‰å£«å®˜é•·": { y: [67185, 75525], e: [44790, 50350], dy: [1020, 1020], de: [680, 680], max: 12 },
    "äºŒç­‰å£«å®˜é•·": { y: [57975, 65535], e: [38650, 43690], dy: [930, 930], de: [620, 620], max: 12 },
    "ä¸‰ç­‰å£«å®˜é•·": { y: [52545, 59370], e: [35030, 39580], dy: [855, 855], de: [570, 570], max: 12 },
    "ä¸Šå£«": { y: [61995, 66690], e: [41330, 44460], dy: [945, 945], de: [630, 630], max: 12 },
    "ä¸­å£«": { y: [61425, 65535], e: [40950, 43690], dy: [810, 810], de: [540, 540], max: 12 },
    "ä¸‹å£«": { y: [50580, 54315], e: [33720, 36210], dy: [810, 810], de: [540, 540], max: 12 },
    "ä¸Šå…µ": { y: [57240, 57240], e: [38160, 38160], dy: [0, 0], de: [0, 0], max: 1 },
    "ä¸€å…µ": { y: [55170, 55170], e: [36780, 36780], dy: [0, 0], de: [0, 0], max: 1 },
    "äºŒå…µ": { y: [53130, 53130], e: [35420, 35420], dy: [0, 0], de: [0, 0], max: 1 }
};

// é‡å°æ‚¨çš„ç‰¹æ®Šæ•¸æ“šé€²è¡Œè¤‡å¯«èˆ‡é©—è­‰ (ä¸­å£«äºŒç´šèˆ‡ä¸Šå£«ä¸€ç´š)
db["ä¸­å£«"].y[1] = 65535; // ä¸­å£«ä¸€ç´šé ˜å°å¹´çµ‚
db["ä¸Šå£«"].e[1] = 45130; // ä¿®æ­£ï¼šä¸Šå£«ä¸€ç´šé ˜å°è€ƒçç‚º 45130

function init() {
    const sel1 = document.getElementById('r1');
    const sel2 = document.getElementById('r2');
    Object.keys(db).forEach(r => {
        sel1.add(new Option(r, r));
        sel2.add(new Option(r, r));
    });
    sel1.value = "ä¸­å£«"; sel2.value = "ä¸Šå£«";
    updateLevels('l1', "ä¸­å£«"); updateLevels('l2', "ä¸Šå£«");
    document.getElementById('l1').value = 1; // é è¨­ä¸­å£«äºŒç´š
}

function updateLevels(id, rank) {
    const lSel = document.getElementById(id);
    const currentVal = lSel.value;
    lSel.innerHTML = "";
    for(let i=1; i<=db[rank].max; i++) {
        lSel.add(new Option(i + "ç´š", i-1));
    }
}

function doCalculate() {
    // å¹´çµ‚è¨ˆç®— (ä¸­å£«)
    const r1 = document.getElementById('r1').value;
    const lv1 = parseInt(document.getElementById('l1').value);
    const b1 = document.getElementById('b1').checked ? 1 : 0;
    let yBase = db[r1].y[b1];
    let yearEnd = yBase + (lv1 * db[r1].dy[b1]);
    
    // ç‰¹æ®Šæ ¡æ­£ï¼šä¸­å£«äºŒç´šé ˜å°å¹´çµ‚æ‡‰ç‚º 66345 (65535+810)
    // ä½†è‹¥æ‚¨èªªä¸­å£«äºŒç´šé ˜ 62235ï¼Œé€™æ˜¯ä¸å‹¾é¸é ˜å°è·æ™‚çš„æ•¸å€¼ (61425+810)
    
    // è€ƒçè¨ˆç®— (ä¸Šå£«)
    const r2 = document.getElementById('r2').value;
    const lv2 = parseInt(document.getElementById('l2').value);
    const b2 = document.getElementById('b2').checked ? 1 : 0;
    const rate = parseFloat(document.getElementById('eval').value);
    let eBase = db[r2].e[b2];
    let evalAmt = (eBase + (lv2 * db[r2].de[b2])) * rate;

    document.getElementById('res_y').innerText = "$" + Math.round(yearEnd).toLocaleString();
    document.getElementById('res_e').innerText = "$" + Math.round(evalAmt).toLocaleString();
    document.getElementById('res_t').innerText = "$" + Math.round(yearEnd + evalAmt).toLocaleString();
    document.getElementById('result').style.display = 'block';
}
init();
</script>
</body>
</html>
